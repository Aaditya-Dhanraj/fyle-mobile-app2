<div [formGroup]="form">
  <div>
    <ng-container *ngIf="mileage_locations.controls.length > 0;else routeEmptyInput">
      <ng-container>
        <ng-container *ngIf="mileage_locations.controls[0]">
          <div class="route-selector--internal-block">
            <app-fy-location class="route-selector--input" [formControl]="mileage_locations.controls[0]"
              (click)="openModal()" [disabled]="true"></app-fy-location>
          </div>
        </ng-container>
        <div *ngIf="mileage_locations.controls.length > 2">
          {{mileage_locations.controls.length - 2}} Stop
        </div>
        <ng-container
          *ngIf="mileage_locations.controls.length > 1 && mileage_locations.controls[mileage_locations.controls.length - 1]">
          <div class="route-selector--internal-block">
            <app-fy-location class="route-selector--input"
              [formControl]="mileage_locations.controls[mileage_locations.controls.length - 1]" (click)="openModal()"
              [disabled]="true"></app-fy-location>
          </div>
        </ng-container>
      </ng-container>
    </ng-container>
    <ng-template #routeEmptyInput>
      <div class="route-selector--internal-block">
        <label class="route-selector--label">
          <div class="route-selector--label-content">
            Route
            <span *ngIf="mileageConfig.location_mandatory" class="route-selector--mandatory">
              *
            </span>
          </div>
          <div class="route-selector--input-container"
            [ngClass]="{'route-selector--input-invalid': !form.controls.mileage_locations.valid}">
            <input class="route-selector--input" type="text" [placeholder]="'Enter Route'" (click)="openModal()"
              [ngClass]="{'route-selector--input-disabled': form.controls.mileage_locations.disabled}"
              [disabled]="form.controls.mileage_locations.disabled">
            <mat-icon class="route-selector--icon"
              [ngClass]="{'route-selector--input-disabled': form.controls.mileage_locations.disabled}"
              svgIcon="fy-arrow-down">
            </mat-icon>
          </div>
        </label>
      </div>
      <div *ngIf="form.controls.mileage_locations.touched && !form.controls.mileage_locations.valid"
        class="route-selector--error">
        Please select location
      </div>
    </ng-template>
  </div>

  <div class="route-selector--internal-block" *ngIf="mileage_locations.controls.length < 3">
    <mat-checkbox [disabled]="isAmountDisabled || !form.controls.distance" formControlName="round_trip">
      <span class="route-selector--checkbox">
        Round Trip
      </span>
    </mat-checkbox>
  </div>

  <ng-container *ngIf="txnFields?.distance">
    <div class="route-selector--text route-selector--internal-block"
      [ngClass]="{'route-selector--text__invalid': form.controls.distance.touched && !form.controls.distance.valid}">
      <div class="route-selector--text-label">Distance
        <ng-container *ngIf="unit; else defaultDistanceUnit">
          <span class="route-selector--text-label__unit"> ({{ unit }})</span>
        </ng-container>

        <ng-template #defaultDistanceUnit>

          <span class="route-selector--text-label__unit"> ({{ mileageConfig.unit }})</span>
        </ng-template>
        <div class="route-selector--mandatory" *ngIf="isDistanceMandatory">
          *
        </div>
      </div>
      <input [disabled]="isAmountDisabled || !txnFields?.distance.canEdit" [min]="0" class="route-selector--text-input"
        formControlName="distance" inputmode="decimal" type="number" placeholder="Enter Distance">
    </div>
    <div *ngIf="form.controls.distance.touched && !form.controls.distance.valid"
      class="route-selector--error route-selector--text-error">
      Please enter the distance
    </div>
  </ng-container>

</div>